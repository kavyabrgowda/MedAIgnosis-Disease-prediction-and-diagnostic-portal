<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prediction Results</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="{{ url_for('static', filename='css/globals.css') }}" rel="stylesheet">
    <script>
        function connectToDoctor(doctorFirstName, doctorLastName, patientFirstName, patientLastName, disease) {
            fetch('/connect_doctor', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        doctorFirstName,
                        doctorLastName,
                        patientFirstName,
                        patientLastName,
                        disease
                    })
                })
                .then(response => response.ok ? alert('Connected to doctor!') : alert('Failed to connect.'));
        }
    </script>
</head>

<body class="font-sans bg-gray-50 min-h-screen flex flex-col justify-center items-center text-center bg-sky-50">

    <div class="absolute top-4 right-20">
        <a href="{{ url_for('landing') }}" class="flex justify-end">
            <span class="flex btn text-blue-600 border-blue-600 md:border-2 hover:bg-blue-600 hover:text-white transition ease-out duration-500 text-2xl px-3 py-1 rounded-lg items-center">
                Home  
                <svg class="w-6 ml-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" />
                </svg>
            </span>
        </a>
    </div>
    <br><br>
    <h2 class="text-2xl font-bold mt-8">Prediction Results</h2>

    {% if prediction %}
    <div id="prediction-result" class="mt-6 text-lg font-semibold text-gray-700">
        <p>Aggregated Predicted Disease: {{ prediction }}</p>
    </div>
    {% endif %}

    <h3 class="text-xl font-semibold mt-8">Recommended Doctors:</h3>
    <ul class="mt-4 space-y-4">
        {% for doctor in doctors %}
        <li class="bg-white shadow-md rounded-lg p-6 text-left">
            <p><strong class="text-gray-800">Name:</strong> {{ doctor.first_name }} {{ doctor.last_name }}</p>
            <p><strong class="text-gray-800">Specialization:</strong> {{ doctor.speciality }}</p>
            <p><strong class="text-gray-800">Education:</strong> {{ doctor.education }}</p>
            <p><strong class="text-gray-800">Hospital:</strong> {{ doctor.hospital_affiliation }}</p>
            <div class="mt-4 text-center w-full">
                <input type="text" id="patientFirstName" placeholder="Enter Patient First Name" class="flex border border-gray-300 rounded-md p-2 w-96 mb-2" required>
                <input type="text" id="patientLastName" placeholder="Enter Patient Last Name" class="flex border border-gray-300 rounded-md p-2 w-96 mb-2" required>
                <button onclick="connectToDoctor('{{ doctor.first_name }}', '{{ doctor.last_name }}', 
                           document.getElementById('patientFirstName').value, 
                           document.getElementById('patientLastName').value, '{{ prediction }}')" class="bg-blue-600 text-white rounded-md px-4 py-2 hover:bg-blue-700">Connect</button>
            </div>
        </li>
        {% endfor %}
    </ul>
</body>

</html>